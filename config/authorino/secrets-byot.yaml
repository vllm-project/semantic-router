# Pattern 1:1 — Bring Your Own Token (BYOT)
#
# The user's Bearer token IS their provider key.
# Authorino looks up this Secret by matching the api_key field,
# then injects the same key as x-user-openai-key (from annotations).
#
# RBAC: BYOT users typically get premium_tier (they're paying for their own keys).
#
# Flow: Dave sends "Bearer sk-byot-dave-own-openai-key-abc123"
#       → Authorino matches this Secret
#       → Injects x-user-openai-key: sk-byot-dave-own-openai-key-abc123
#       → Injects x-authz-user-id: dave
#       → Injects x-authz-user-groups: premium
#       → ext_proc: role_bindings maps group "premium" → role "premium_tier"
#       → decision: premium_tier → gpt-4o (full access)
#
apiVersion: v1
kind: Secret
metadata:
  name: dave                               # ← becomes x-authz-user-id
  labels:
    app: semantic-router
    authorino.kuadrant.io/managed-by: authorino
  annotations:
    openai-key: "sk-byot-dave-own-openai-key-abc123"
    anthropic-key: "sk-ant-byot-dave-own-anthropic-key-xyz"
    authz-groups: "premium"                # ← becomes x-authz-user-groups
stringData:
  api_key: "sk-byot-dave-own-openai-key-abc123"   # same as the user's own OpenAI key
type: Opaque
